# Etapa 1: Instalar depend√™ncias e construir a aplica√ß√£o
FROM node:20 AS builder
WORKDIR /teste
COPY package.json package-lock.json ./
RUN npm install
COPY . .
RUN npm run build

---
# Etapa 2: Executar a aplica√ß√£o em um ambiente leve (Runtime)
FROM node:20-alpine
WORKDIR /teste

# üí° A√ß√£o Correta: Copiar TUDO da pasta /teste do builder para o /teste do runtime.
# Isso inclui: .next, node_modules, package.json, src/ e todos os outros arquivos necess√°rios.
COPY --from=builder /teste/. .

# O Next.js usa a porta 3000 por padr√£o.
EXPOSE 3000

# Comando para iniciar o servidor Next.js em produ√ß√£o
CMD ["npm", "start"]