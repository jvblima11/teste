# Etapa 1: Instalar depend√™ncias e construir a aplica√ß√£o
FROM node:20 AS builder
WORKDIR /app
COPY package.json package-lock.json ./
RUN npm install
COPY . .

# üö® CORRE√á√ÉO: Aplicar a vari√°vel NEXT_FONT_GOOGLE_OPTIMIZED=false aqui, na etapa de build.
RUN npm run build
# RUN NEXT_FONT_GOOGLE_OPTIMIZED=false npm run build

# Etapa 2: Executar a aplica√ß√£o em um ambiente leve
# Use node:20-alpine para uma imagem final mais leve.
FROM node:20-alpine
WORKDIR /app

# ... (restante da c√≥pia de arquivos)

# O Next.js usa a porta 3000 por padr√£o.
EXPOSE 3000

# Comando para iniciar o servidor Next.js em produ√ß√£o
CMD ["npm", "start"]